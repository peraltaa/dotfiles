;; -*- mode:lisp -*-

(in-package :lem-user)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Looks 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; (define-color-theme "monokai" ()
;;   (foreground "#eeeeee")
;;   (background "#262626")
;;   (cursor :foreground "#262626" :background "#eeeeee")
;;   (syntax-warning-attribute :foreground "#87005f" :background "#262626")
;;   (syntax-string-attribute :foreground "#d7d787" :background "#262626")
;;   (syntax-comment-attribute :foreground "#666666" :background "#262626")
;;   (syntax-keyword-attribute :foreground "#5fd7ff" :background "#262626")
;;   (syntax-constant-attribute :foreground "#5fd7ff" :background "#262626")
;;   (syntax-function-name-attribute :foreground "#afd700" :background "#262626")
;;   (syntax-variable-attribute :foreground nil :background "#262626")
;;   (syntax-type-attribute :foreground nil :background "#262626")
;;   (syntax-builtin-attribute :foreground nil :background "#262626"))

(define-color-theme "xcode" ()
  (:display-background-mode :light)
  (:foreground "#000000")
  (:background "#ffffff")
  (:inactive-window-background nil)
  (cursor :foreground "#ffffff" :background "#000000")
  (region :foreground nil :background "#FFFFFF")
  (modeline :background "grey" :foreground "white")
  (modeline-inactive :background "#303030" :foreground "gray")
  (syntax-string-attribute :foreground "#d70000")
  (syntax-comment-attribute :foreground "#008000")
  (syntax-keyword-attribute :foreground "#af0087")
  (syntax-constant-attribute :foreground "#ff00ff")
  (syntax-function-name-attribute :foreground "#A4CDFF")
  (syntax-variable-attribute :foreground "#ffffff")
  (syntax-type-attribute :foreground nil :background "#ffffff"))

(define-color-theme "xcode-dark" ("xcode")
  (:display-background-mode :dark)
  (:foreground "#FFFFFF")
  (:background "#202020")
  (:inactive-window-background nil)
  (cursor :foreground "#ffffff" :background "#000000")
  (region :foreground nil :background "#FFFFFF")
  (modeline :bold t :background "#292929" :foreground "#1E2028")
  (modeline-inactive :bold t :background "#383838" :foreground "white")
  (lem-core::modeline-name-attribute :foreground "#5DD8FF")
  (lem-core::inactive-modeline-name-attribute :foreground "#5d6dff")
  (lem-core::modeline-major-mode-attribute :foreground "#5DD8FF")
  (lem-core::inactive-modeline-major-mode-attribute :foreground "#5d6dff")
  (lem-vi-mode/modeline::state-modeline-yellow :foreground "grey" :reverse t)
  (lem-vi-mode/modeline::state-modeline-orange :foreground "#41B645" :reverse t)
  (lem-vi-mode/modeline::state-modeline-green :foreground "#A2E474" :reverse t)
  (syntax-string-attribute :foreground "#FC6A5D")
  (syntax-comment-attribute :foreground "#6C7986")
  (syntax-keyword-attribute :foreground "#FC5FA3")
  (syntax-constant-attribute :foreground "#A167E6")
  (syntax-function-name-attribute :foreground "#67B7A4")
  (syntax-variable-attribute :foreground "#67B7A4")
  (syntax-type-attribute :foreground "#9EF1DD"))

(load-library "lem-pygments-colorthemes")
(load-theme "xcode-dark")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Vars 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(setf *scroll-recenter-p* t)
;; (setf (variable-value 'truncate-lines                :global) nil)
(setf (variable-value 'lem/line-numbers:line-numbers :global) t)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Init Modes 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; VI
(lem-vi-mode:vi-mode)

;; PAREDIT
;; (lem:add-hook lem:*find-file-hook*
;;               (lambda (buffer)
;;                 (when (eq (buffer-major-mode buffer) 'lem-lisp-mode:lisp-mode)
;;                   (change-buffer-mode buffer 'lem-paredit-mode:paredit-mode t))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Keybindings
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; General
(define-key lem:*global-keymap* "Space f f" 'lem:find-file)
(define-key lem:*global-keymap* "Space b b" 'lem:select-buffer)

;; VI
(define-key lem-vi-mode:*normal-keymap* "q"  'quit-active-window)
(define-key lem-vi-mode:*normal-keymap* "Space f f" 'lem:find-file)
(define-key lem-vi-mode:*normal-keymap* "Space b b" 'lem:select-buffer)
(define-key lem-vi-mode:*motion-keymap* "Space w h" 'lem:window-move-left)
(define-key lem-vi-mode:*motion-keymap* "Space w l" 'lem:window-move-right)
(define-key lem-vi-mode:*motion-keymap* "Space w k" 'lem:window-move-up)
(define-key lem-vi-mode:*motion-keymap* "Space w j" 'lem:window-move-down)
(define-key lem-vi-mode:*motion-keymap* "Space w s" 'lem:split-active-window-vertically)
(define-key lem-vi-mode:*motion-keymap* "Space w v" 'lem:split-active-window-horizontally)
;; (define-key lem-vi-mode:*insert-keymap* "C-n" 'lem/abbrev:abbrev-with-pop-up-window)
;; (define-key lem-vi-mode:*insert-keymap* "j k" 'lem-vi-mode/commands:vi-end-insert)

;; CL
(define-key lem-lisp-mode:*lisp-mode-keymap* "Space e e" 'lem-lisp-mode:lisp-eval-last-expression)
(define-key lem-lisp-mode:*lisp-mode-keymap* "Space e f" 'lem-lisp-mode:lisp-load-file)